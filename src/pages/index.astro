---
import { getCollection } from 'astro:content';
import BaseLayout from '../layouts/BaseLayout.astro';
import { SITE } from '../consts';

const posts = (await getCollection('posts'))
  .sort((a, b) => new Date(b.data.date || 0).getTime() - new Date(a.data.date || 0).getTime())
  .slice(0, 12);
---
<BaseLayout title={SITE.name} description={SITE.description}>
  <section class="hero">
    <h2>Latest from PickyFox</h2>
    <p class="meta">Fresh picks, reviews, and curated finds.</p>
  </section>
  <section class="grid">
    {posts.map((post) => (
      <article class="card">
        {post.data.featureImage && (
          <img src={post.data.featureImage} alt={post.data.featureImageAlt || post.data.title} />
        )}
        <h3><a href={`/${post.slug}/`}>{post.data.title}</a></h3>
        <p class="meta">{new Date(post.data.date || '').toLocaleDateString('en-US', { year: 'numeric', month: 'short', day: 'numeric' })}</p>
        {post.data.excerpt && <p>{post.data.excerpt}</p>}
      </article>
    ))}
  </section>
</BaseLayout>
